Лабораторная работа No 4. Взаимодействие и синхронизация
процессов
Синхронизация процессов с помощью сигналов и обработка сигналов таймера.
Задача — управление дочерними процессами и упорядочение вывода в stdout от
них, используя сигналы SIGUSR1 и SIGUSR2.
Действия родительского процесса
По нажатию клавиши «+» pодительский процесс (P) порождает дочерний процесс
(C_k) и сообщает об этом.
По нажатию клавиши «-» P удаляет последний порожденный C_k, сообщает об
этом и о количестве оставшихся.
При вводе символа «k» P удаляет все C_k и сообщает об этом.
При вводе символа «s» P запрещает всем C_k выводить статистику (см. ниже).
При вводе символа «g» P разрешает всем C_k выводить статистику.
При вводе символов «s<num>» P запрещает C_<num> выводить статистику.
При вводе символов «g<num>» P разрешает C_<num> выводить статистику.
При вводе символов «p<num>» P запрещает всем C_k вывод и запрашивает
C_<num> вывести свою статистику. По истечению заданного времени (5 с, например),
если не введен символ «g», разрешает всем C_k снова выводить статистику.
По нажатию клавиши «q» P удаляет все C_k, сообщает об этом и завершается.
Действия дочернего процесса
Дочерний процесс во внешнем цикле заводит будильник (nanosleep(2)) и входит в
вечный цикл, в котором в режиме чередования заполняет структуру, содержащую пару
переменных типа int, значениями {0, 0} и {1, 1} (см. раздел «Проблемы неатомарного
доступа» темы «Сигналы»).
При получении сигнала от будильника проверяет содержимое структуры, собирает
статистику и повторяет тело внешнего цикла.
Через заданное количество повторений внешнего цикла (например, через 101)
дочерний процесс, если ему разрешено, выводит свои PPID, PID и 4 числа — количество
разных пар, зарегистрированных в момент получения сигнала от будильника.
Вывод осуществляется посимвольно.
C_k запрашивает доступ к stdout у P и осуществляет вывод после подтверждения.
По завершению вывода C_k сообщает P об этом.
Следует подобрать интервал времени ожидания и количество повторений внеш-
него цикла, чтобы статистика была значимой.
